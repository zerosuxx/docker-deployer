#!/usr/bin/env bash

set -e

sysctl fs.inotify.max_user_instances=1280
sysctl fs.inotify.max_user_watches=655360
curl -s https://raw.githubusercontent.com/k3d-io/k3d/main/install.sh | bash

if [[ "$@" == *"--wait-for-docker"* ]]; then
    echo -n "Waiting for dockerd"
    until $(curl --output /dev/null --silent --head http://localhost:2375); do printf '.'; sleep 5; done
fi
